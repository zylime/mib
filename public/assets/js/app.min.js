"use strict";$.fn.Calender=function(e){var s=$(this).find(".js-calendar-container");!function(){for(var e=0;e<12;e++){var t=new Date,n=".js-calendar-"+(e+1);t.setDate(1),t.setMonth(t.getMonth()-6+e),s.append('<div class="c-calendar--block js-calendar js-calendar-'+(e+1)+'" data-time="'+t+'"></div>'),$(n).calendar({date:t,daysMin:["日","一","二","三","四","五","六"]})}s.append('<input type="hidden" name="selectDate" class="js-calendar-select-date">')}()},$.fn.Carousel=function(e){$(this).slick({infinite:!0,arrows:!1,dots:!1})},$.fn.Collapse=function(e){var i,o,a=$.extend({text:!1},e),r=$(this).find(".js-collapse-container"),t=$(this).find(".js-collapse-content"),c=$(this).find(".js-collapse-btn");a.text&&(i="阅读更多",o="收起");var d=r.height();!function(){var n,s=t.height();d<s&&(c.attr("data-expanded",!1).removeClass("hide"),a.text&&c.find("span").html(i),n=s);c.on("click",function(){var e="true"==$(this).attr("data-expanded")?"false":"true";if(r.animate({height:n+"px"}),c.attr("data-expanded",e),n=n==d?s:d,a.text){var t=$(this).find("span").html()==i?o:i;c.find("span").html(t)}})}()},$(document).ready(function(){$(document).Popups(),$("[data-js-sign-in]").SignIn(),$("[data-js-sign-in-by-mobile]").MobileVerification(),$("[data-js-register]").Register(),$("[data-js-order-detail]").OrderDetail(),$("[data-js-prepay]").PrePay(),$("[data-js-payment-method]").PaymentMethod(),$("[data-js-home]").Home(),$("[data-js-project-list]").ProjectList(),$("[data-js-carousel]").Carousel(),$("[data-js-store-comments]").StoreComments(),$("[data-js-password]").TogglePsw(),$("[data-js-calendar]").Calender(),$("[data-js-forget-psw]").forgetPsw(),$("[data-js-reset-psw]").resetPsw(),$("[data-js-collapse]").Collapse({text:!0}),$("[data-js-search]").Search(),lightbox.option({resizeDuration:200,wrapAround:!0})}),$.fn.forgetPsw=function(e){$(this);var t=$(this).find(".js-code"),n=$(this).find(".js-submit"),s=$(this).find(".js-forget-psw-form");t.on("click touch",function(){if(!$(this).hasClass("disabled")){var e=60,t=this;$(this).addClass("disabled");var n=setInterval(function(){e-=1,$(t).html("重新发送 ("+e+")"),0==e&&(clearInterval(n),$(t).html("发送验证码"),$(t).removeClass("disabled"))},1e3)}}),n.on("click touch",function(){var e=s.serialize();$.ajax({type:"POST",dataType:"text",url:"",data:e,success:function(e){}})})},$.fn.Home=function(e){$(this).find(".js-categories-slider").slick({dots:!1,infinite:!1,slidesToShow:4,arrows:!1})},$.fn.MobileVerification=function(){var i=$(this).find(".js-mobile-number"),o=$(".js-popup-code"),a=o.find(".js-popup-code-form"),e=o.find(".js-popup-code-submit"),r=o.find(".js-error");e.on("click touch",function(){var e="";o.find('input[name="phone"]').val(i.val()),o.find("input.js-code").each(function(){e+=$(this).val().toString()}),o.find('input[name="code"]').val(e),a.serializeJson();var t="http://mib.zengpan.org:8000/register?",n=a.serializeJson();n._response={status:100,message:"success"},n=JSON.stringify(n),t+=n;var s=new XMLHttpRequest;s.open("GET",encodeURI(t),!0),s.onerror=s.onabort=s.ontimeout=function(e){console.log(e)},s.send(),s.onreadystatechange=function(){if(s.readyState==s.DONE&&200==s.status){var e=$.parseJSON(s.response).status,t=$.parseJSON(s.response).message;100==e?(r.hide(),window.location.href="./index.html"):(r.html(t),r.show())}}})},$.fn.OrderDetail=function(e){var t=$(this).find(".js-order-detail-checkbox"),n=$(this).find(".js-user-info p"),s=$(this).find('.js-user-info input[name="userName"]'),i=$(this).find('.js-user-info input[name="userId"]'),o=$(this).find(".js-user-info .js-btn");function a(){var e=s.val()+" "+i.val();n.html(e)}t.on("click touch",function(){var e=""==$(this).attr("data-value")?"checked":"";$(this).toggleClass("active"),$(this).attr("data-value",e),$(this).next().val(e)}),o.html(),a(),o.on("click touch",function(){s.toggle(),i.toggle(),n.toggle(),a()}),0<$(".js-datepicker").length&&$(".js-datepicker").dateRangePicker({language:"cn"})},$.fn.PaymentMethod=function(e){$(this);var t=$(this).find(".js-checkbox");t.each(function(){$(this).on("click touch",function(){t.each(function(){$(this).attr("data-checked","").removeClass("active"),$(this).prev().val("")}),$(this).addClass("active"),$(this).attr("data-checked","checked"),$(this).prev().val("checked")})})},$.fn.Popups=function(e){$(this);function t(e){(e=e).hide(),$(".js-popup-cover").hide()}$(document).on("click touch",".js-open-popup-code",function(e){e.stopPropagation(),$(".js-popup-code").show(),$(".js-popup-cover").show()}),$(document).on("click touch",".js-popup-cover, .js-close-popup-code",function(e){e.stopPropagation(),t($(".js-popup-code"))}),$(".js-popup-code-verification-btn").on("click touch",function(){var e=60,t=this;$(this).attr("disabled","disabled");var n=setInterval(function(){e-=1,$(t).html("重新发送 ("+e+")"),0==e&&(clearInterval(n),$(t).html("发送验证码"),$(t).removeAttr("disabled"))},1e3)}),$(".js-popup-code").find("input.js-code").each(function(e){var t=e;$(this).on("keydown",function(){1==$(this).val().length&&0<$($(".js-popup-code").find("input.js-code")[t+1]).length&&$($(".js-popup-code").find("input")[t+1]).focus()}),$(this).on("input.js-code",function(){!function(){for(var e=$(".js-popup-code").find("input.js-code").length,t=0;t<e&&0!=$($(".js-popup-code").find("input.js-code")[t]).val().length;t++)t==e-1&&$(".js-popup-code").find(".js-btn").removeClass("disabled")}()})}),$(document).on("click touch",".js-popup-cover, .js-close-register",function(e){e.stopPropagation(),t($(".js-popup-register"))}),$(document).on("click touch",".js-popup-cover",function(e){e.stopPropagation(),t($(".js-popup-reset-psw"))})},$.fn.PrePay=function(e){$(this);var t,n=$(this).find(".js-checkbox"),s=$(this).find(".js-price"),i=$(this).find(".js-total"),o="¥";n.on("click touch",function(){var e=""==$(this).attr("data-checked")?"checked":"";$(this).toggleClass("active"),$(this).attr("data-checked",e),$(this).prev().val(e)}),t=0,s.each(function(){var e=parseInt($(this).attr("data-price"));t+=e}),t=Number(t).toFixed(2),i.attr("data-price",t).html(o+t)},$.fn.ProjectList=function(e){var t=$(this).find(".js-categories-slider"),n=$(this).find(".js-favorite");t.slick({dots:!1,infinite:!1,slidesToShow:3,arrows:!1}),n.each(function(){$(this).on("click touch",function(e){e.preventDefault(),e.stopPropagation(),$(this).toggleClass("active")})})},$.fn.Register=function(e){$(this);var n,t=$(this).find(".js-checkbox"),s=$(this).find(".js-register-form"),i=$(this).find(".js-register-btn"),a=$(this).find(".js-error"),r=$(".js-popup-verify-email"),c=r.find(".js-verify-btn"),d=r.find(".js-resend-btn"),u=r,l=r.find(".js-error"),h=$(".js-popup-code"),p=h.find(".js-popup-code-form"),f=h.find(".js-popup-code-submit"),m=h.find(".js-error"),o=$(".js-popup-register");function v(){var e=60;d.attr("disabled","disabled");var t=setInterval(function(){e-=1,d.html("重新发送 ("+e+")"),0==e&&(clearInterval(t),d.html("发送验证码"),d.removeAttr("disabled"))},1e3)}function j(e){(e=e).show(),$(".js-popup-cover").show()}function g(e){(e=e).hide(),$(".js-popup-cover").hide()}function w(){g(r),g(h),j(o),o.find("a").on("click touch",function(){window.location.href="./index.html"})}t.on("click touch",function(){var e=$(this).hasClass("checked")?"false":"true";$(this).toggleClass("checked"),$(this).find("input").val(e)}),n=!1,s.find("input").on("keydown",function(){for(var e=s.find("input").length,t=0;t<e;t++){if(""==$(s.find("input")[t]).val()){n=!1;break}n=!0}n&&i.removeAttr("disabled")}),i.on("click touch",function(e){s.validate({rules:{name:"required",email_mobile:"required",pwd:"required"},messages:{user:"请输入昵称",email_mobile:"请输入邮箱或手机号",pwd:"请输入密码"},submitHandler:function(e){var t=s.find('input[name="email_mobile"]').val();!function(i){var i=i,e=(s.serializeJson(),"http://mib.zengpan.org:8000/register?"),t=s.serializeJson();t._response={status:100,message:"succeed"},t=JSON.stringify(t),e+=t;var o=new XMLHttpRequest;o.open("GET",encodeURI(e),!0),o.onerror=o.onabort=o.ontimeout=function(e){console.log(e)},o.send(),o.onreadystatechange=function(){if(o.readyState==o.DONE&&200==o.status){var e=$.parseJSON(o.response).status,t=$.parseJSON(o.response).message;100==e?(a.hide(),0<i.indexOf("@")?(s=s=i,r.find(".js-display-email").html(s),r.find('input[name="userEmail"]').val(s),j(r),v(),d.on("click touch",function(e){e.preventDefault(),v()}),c.on("click touch",function(e){e.preventDefault(),u.serializeJson();var t=u.serializeJson(),n="http://mib.zengpan.org:8000/register?";t._response={status:100,message:"success"},t=JSON.stringify(t),n+=t;var s=new XMLHttpRequest;s.open("GET",encodeURI(n),!0),s.onerror=s.onabort=s.ontimeout=function(e){console.log(e)},s.send(),s.onreadystatechange=function(){if(s.readyState==s.DONE&&200==s.status){var e=$.parseJSON(s.response).status,t=$.parseJSON(s.response).message;100==e?(l.hide(),w()):(l.html(t),l.show())}}}),$(document).on("click touch",".js-popup-cover, .js-close-verify-email",function(e){e.stopPropagation(),g(r)})):(n=n=i,h.find('input[name="phone"]').val(n),j(h),f.on("click touch",function(){var e="";h.find("input.js-code").each(function(){e+=$(this).val().toString()}),h.find('input[name="code"]').val(e),p.serializeJson();var t="http://mib.zengpan.org:8000/register?",n=p.serializeJson();n._response={status:100,message:"success"},n=JSON.stringify(n),t+=n;var s=new XMLHttpRequest;s.open("GET",encodeURI(t),!0),s.onerror=s.onabort=s.ontimeout=function(e){console.log(e)},s.send(),s.onreadystatechange=function(){if(s.readyState==s.DONE&&200==s.status){console.log(s);var e=$.parseJSON(s.response).status,t=$.parseJSON(s.response).message;100==e?(m.hide(),w()):(m.html(t),m.show())}}}))):(a.html(t),a.show())}var n,s}}(t)}})})},$.fn.resetPsw=function(e){$(this);var t=$(this).find(".js-submit"),i=$(this).find(".js-reset-psw-form"),o=$(this).find(".js-input-psw1"),a=$(this).find(".js-input-psw2"),r=$(this).find(".js-warning");t.on("click",function(e){e.preventDefault();var t=o.val(),n=a.val();if(""==t||""==n)r.html("请输入密码"),r.show();else if(t!==n)r.html("密码不匹配"),r.show();else{r.hide();var s=i.serialize();console.log(s),$.ajax({type:"POST",dataType:"text",url:"",data:s,success:function(e){}})}})},$.fn.Search=function(e){var t,n,s,i,o=$(this).find(".js-clear-btn"),a=$(this).find(".js-result-container"),r=$(this).find(".js-history-view-more");o.on("click touch",function(e){a.html(""),r.addClass("hide"),$(".js-history-view-more").attr("data-expanded","false").html("更多")}),156<(i=$(".js-history-list").height())&&(n="更多",$(".js-history-view-more").html(n),$(".js-history-view-more").removeClass("hide"),t=i),$(".js-history-view-more").on("click",function(){s="true"==$(this).attr("data-expanded")?"false":"true",$(".js-history-box").animate({height:t+"px"}),$(this).attr("data-expanded",s),t=156==t?i:156,n="更多"==n?"收起":"更多",$(".js-history-view-more").html(n)})},$.fn.serializeJson=function(){var e={},t=this.serializeArray();return $(t).each(function(){e[this.name]?$.isArray(e[this.name])?e[this.name].push(this.value):e[this.name]=[e[this.name],this.value]:e[this.name]=this.value}),e},$.fn.SignIn=function(e){$(this);var s=$(this).find(".js-sign-in-form"),t=$(this).find(".js-dropdown-body"),n=$(this).find(".js-dropdown-body .js-remove"),i=$(this).find(".js-dropdown-btn"),o=$(this).find(".js-sign-in-submit"),a=s.find(".js-error");i.on("click touch",function(){0==!t.find("li").length&&t.slideToggle()}),$(document).on("click touch",function(e){e.stopPropagation(),$(e.target).parents(".c-sign-in--form").length<=0&&t.slideUp()}),n.each(function(){$(this).on("click touch",function(e){$(this).parents("li").remove(),0==t.find("li").length&&t.slideToggle()})}),t.find("span").on("click touch",function(){var e=$(this).html();t.siblings("input").val(e)}),o.on("click touch",function(e){s.validate({rules:{user:"required",pwd:"required"},messages:{user:"请输入用户名",pwd:"请输入密码"},submitHandler:function(){!function(){s.serializeJson();var e="http://mib.zengpan.org:8000/register?",t=s.serializeJson();t._response={status:100,message:"success"},t=JSON.stringify(t),e+=t;var n=new XMLHttpRequest;n.open("GET",encodeURI(e),!0),n.onerror=n.onabort=n.ontimeout=function(e){console.log(e)},n.send(),n.onreadystatechange=function(){if(n.readyState==n.DONE&&200==n.status){var e=$.parseJSON(n.response).status,t=$.parseJSON(n.response).message;100==e?(a.hide(),window.location.href="./index.html"):(a.html(t),a.show())}}}()}})})},$.fn.StoreComments=function(e){$(this).find(".js-comments-body")},$.fn.TogglePsw=function(e){var t=$(this).find(".js-psw-input"),n=$(this).find(".js-psw-eye");n.on("click touch",function(){var e="password"==t.attr("type")?"text":"password";n.toggleClass("close"),t.attr("type",e)})};